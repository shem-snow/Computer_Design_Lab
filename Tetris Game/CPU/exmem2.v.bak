module exmem2 #(parameter DATA_WIDTH=8, parameter ADDR_WIDTH=8)
        (
	input [(DATA_WIDTH-1):0] data,
	input [(ADDR_WIDTH-1):0] addr,
	input [(DATA_WIDTH-1):0] data2,
	input [(ADDR_WIDTH-1):0] addr2,
	input wen1, wen2, clk,
	output [(DATA_WIDTH-1):0] q,
	output reg [(DATA_WIDTH-1):0] q2
        );

	// Declare Wire IO
	wire IO;
	
	assign IO = (addr[7:6] == 2'b11);
	// Declare the RAM variable
	reg [DATA_WIDTH-1:0] ram[2**ADDR_WIDTH-1:0];

	// Variable to hold the read address
	reg [ADDR_WIDTH-1:0] addr_reg;
	reg [ADDR_WIDTH-1:0] addr_reg2;
		
	// Load RAM data from an external file
	initial begin
		$display("Loading memory");
		$readmemh("C:/Users/irbk1/Desktop/ECE3710/MipsLab/fibpleaseberight.dat", ram);
		$display("done loading");
	end

	always @ (negedge clk) begin
		  if (wen) begin
				 ram[addr] <= data;
				 end
		 if (wen2) begin
				 ram[addr2] <= data2;
				 end
		addr_reg <= addr;
		addr_reg2 <= addr2;
	end

	// Continuous assignment implies read returns NEW data
	assign q = ram[addr_reg];
	assign q2 = ram[addr_reg2];

endmodule // exmem
